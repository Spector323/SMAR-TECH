import{h as t,isVue3 as e,install as i,defineComponent as r,Comment as s}from"vue-demi";import a from"diacritics";const h=t=>t.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),l=t=>{let e;if(t.query instanceof RegExp)return new RegExp(String.raw`(${t.query.source})`,"g"+(t.caseSensitive?"":"i"));const i=(t=>{if("partial"===t)return t=>h(t);{const t=String.raw`[\s/(\[{<'"|（『「\u3000]`,e=String.raw`[.,\s/)\]}>:;'"!?|）』」。、\u3000]`;return i=>String.raw`(?<=^|${t})${h(i)}(?=$|${e})`}})(t.matchMode);if(t.splitBySpace){const r=t.query.trim().replace(/\s+/g," ");e=String.raw`(${r.split(/\s/).map(i).join("|")})`}else e=String.raw`(${i(t.query)})`;return new RegExp(String.raw`${e}`,"g"+(t.caseSensitive?"":"i"))},g=(e,i,r=!1)=>{if(!i.query||i.query instanceof String&&!i.query.trim())return e;let s=e,h=i.query,g=!1;i.diacriticsSensitive||(s=a.remove(s),h=i.query instanceof RegExp?new RegExp(a.remove(i.query.source)):a.remove(i.query),g=s!==e);const n=l({query:h,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,matchMode:i.matchMode}),p=s.split(n),c=g?((t,e)=>{const i=[];return e.forEach((e=>{const r=i.join("").length,s=r+e.length;i.push(t.slice(r,s))})),i})(e,p):p;return r?p.map(((t,e)=>{if(n.test(t)){const t=i.highlightClass?` class="${i.highlightClass}"`:"",r=i.highlightStyle?` style="${i.highlightStyle}"`:"";return`<${i.highlightTag}${t}${r}>${c[e]}</${i.highlightTag}>`}return c[e]})).join(""):p.map(((e,r)=>n.test(e)?t(i.highlightTag,{class:i.highlightClass,style:i.highlightStyle},c[r]):c[r]))},n=t=>Array.isArray(t.children)?t.children.map(n).join(""):t.children??"",p=t=>"string"==typeof t?[]:t.filter((t=>"string"!=typeof t)).map((t=>"string"==typeof t?t:e?t.children:t.children[0].text));i();var c=r({name:"VueWordHighlighter",props:{query:{type:[String,RegExp],required:!0,default:""},caseSensitive:{type:Boolean,default:!1},diacriticsSensitive:{type:Boolean,default:!1},splitBySpace:{type:Boolean,default:!1},matchMode:{type:String,default:"partial"},highlightClass:{type:[Object,String,Array],default:""},highlightStyle:{type:[Object,String,Array],default:""},highlightTag:{type:String,default:"mark"},wrapperTag:{type:String,default:"span"},wrapperClass:{type:[Object,String,Array],default:""},textToHighlight:{type:String,default:""},htmlToHighlight:{type:String,default:""}},emits:["matches"],setup:(i,r)=>()=>{if(i.htmlToHighlight){if(!e)throw new Error("htmlToHighlight prop is only supported in Vue 3");const r="(<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>)",s=i.htmlToHighlight.split(new RegExp(r,"gs")),a=s.map(((t,e)=>new RegExp(r).test(t)||e>0&&s[e-1].startsWith("<script")?t:g(t,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,matchMode:i.matchMode,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle},!0))).join("");return t(i.wrapperTag,{class:i.wrapperClass,innerHTML:a})}if(i.textToHighlight){const e=g(i.textToHighlight,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,matchMode:i.matchMode,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle});return r.emit("matches",p(e)),t(i.wrapperTag,{class:i.wrapperClass},e)}if(!e){const s=(t=>{if(t&&t.default){const i=t.default();let r;return r=e?n(i[0]):i[0].text,"string"==typeof r?r:("production"!==process.env.NODE_ENV&&console.warn("Slots should be text only"),"")}return""})(r.slots),a=g(s,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,matchMode:i.matchMode,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle});return r.emit("matches",p(a)),t(i.wrapperTag,{class:i.wrapperClass},a)}if(r.slots&&r.slots.default){const e=a=>{if(a.type===s)return a;if("string"==typeof a.children){const e=g(a.children,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,matchMode:i.matchMode,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle}),s=p(e);return r.emit("matches",s),0===s.length?a:"string"==typeof a.type?t(a.type,{...a.props},[t(i.wrapperTag,{class:i.wrapperClass},e)]):t(i.wrapperTag,{class:i.wrapperClass},e)}return t(a.type,{...a.props},Array.isArray(a.children)?a.children.map((t=>e(t))):[])},a=r.slots.default();return Array.isArray(a)?a.map((t=>e(t))):a}}});export{c as default};//# sourceMappingURL=vue-word-highlighter.esm.js.map
