"use strict";var e=require("vue-demi"),t=require("diacritics");const i=e=>e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),r=e=>{let t;if(e.query instanceof RegExp)return new RegExp(String.raw`(${e.query.source})`,"g"+(e.caseSensitive?"":"i"));const r=(e=>{if("partial"===e)return e=>i(e);{const e=String.raw`[\s/(\[{<'"|（『「\u3000]`,t=String.raw`[.,\s/)\]}>:;'"!?|）』」。、\u3000]`;return r=>String.raw`(?<=^|${e})${i(r)}(?=$|${t})`}})(e.matchMode);if(e.splitBySpace){const i=e.query.trim().replace(/\s+/g," ");t=String.raw`(${i.split(/\s/).map(r).join("|")})`}else t=String.raw`(${r(e.query)})`;return new RegExp(String.raw`${t}`,"g"+(e.caseSensitive?"":"i"))},s=(i,s,h=!1)=>{if(!s.query||s.query instanceof String&&!s.query.trim())return i;let a=i,l=s.query,g=!1;s.diacriticsSensitive||(a=t.remove(a),l=s.query instanceof RegExp?new RegExp(t.remove(s.query.source)):t.remove(s.query),g=a!==i);const n=r({query:l,splitBySpace:s.splitBySpace,caseSensitive:s.caseSensitive,matchMode:s.matchMode}),p=a.split(n),c=g?((e,t)=>{const i=[];return t.forEach((t=>{const r=i.join("").length,s=r+t.length;i.push(e.slice(r,s))})),i})(i,p):p;return h?p.map(((e,t)=>{if(n.test(e)){const e=s.highlightClass?` class="${s.highlightClass}"`:"",i=s.highlightStyle?` style="${s.highlightStyle}"`:"";return`<${s.highlightTag}${e}${i}>${c[t]}</${s.highlightTag}>`}return c[t]})).join(""):p.map(((t,i)=>n.test(t)?e.h(s.highlightTag,{class:s.highlightClass,style:s.highlightStyle},c[i]):c[i]))},h=e=>Array.isArray(e.children)?e.children.map(h).join(""):e.children??"",a=t=>"string"==typeof t?[]:t.filter((e=>"string"!=typeof e)).map((t=>"string"==typeof t?t:e.isVue3?t.children:t.children[0].text));e.install();var l=e.defineComponent({name:"VueWordHighlighter",props:{query:{type:[String,RegExp],required:!0,default:""},caseSensitive:{type:Boolean,default:!1},diacriticsSensitive:{type:Boolean,default:!1},splitBySpace:{type:Boolean,default:!1},matchMode:{type:String,default:"partial"},highlightClass:{type:[Object,String,Array],default:""},highlightStyle:{type:[Object,String,Array],default:""},highlightTag:{type:String,default:"mark"},wrapperTag:{type:String,default:"span"},wrapperClass:{type:[Object,String,Array],default:""},textToHighlight:{type:String,default:""},htmlToHighlight:{type:String,default:""}},emits:["matches"],setup:(t,i)=>()=>{if(t.htmlToHighlight){if(!e.isVue3)throw new Error("htmlToHighlight prop is only supported in Vue 3");const i="(<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>)",r=t.htmlToHighlight.split(new RegExp(i,"gs")),h=r.map(((e,h)=>new RegExp(i).test(e)||h>0&&r[h-1].startsWith("<script")?e:s(e,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,matchMode:t.matchMode,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle},!0))).join("");return e.h(t.wrapperTag,{class:t.wrapperClass,innerHTML:h})}if(t.textToHighlight){const r=s(t.textToHighlight,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,matchMode:t.matchMode,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle});return i.emit("matches",a(r)),e.h(t.wrapperTag,{class:t.wrapperClass},r)}if(!e.isVue3){const r=(t=>{if(t&&t.default){const i=t.default();let r;return r=e.isVue3?h(i[0]):i[0].text,"string"==typeof r?r:("production"!==process.env.NODE_ENV&&console.warn("Slots should be text only"),"")}return""})(i.slots),l=s(r,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,matchMode:t.matchMode,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle});return i.emit("matches",a(l)),e.h(t.wrapperTag,{class:t.wrapperClass},l)}if(i.slots&&i.slots.default){const r=h=>{if(h.type===e.Comment)return h;if("string"==typeof h.children){const r=s(h.children,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,matchMode:t.matchMode,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle}),l=a(r);return i.emit("matches",l),0===l.length?h:"string"==typeof h.type?e.h(h.type,{...h.props},[e.h(t.wrapperTag,{class:t.wrapperClass},r)]):e.h(t.wrapperTag,{class:t.wrapperClass},r)}return e.h(h.type,{...h.props},Array.isArray(h.children)?h.children.map((e=>r(e))):[])},h=i.slots.default();return Array.isArray(h)?h.map((e=>r(e))):h}}});module.exports=l;//# sourceMappingURL=vue-word-highlighter.cjs.js.map
